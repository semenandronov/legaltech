# Руководство по тестированию Legal AI Vault

## Подготовка к тестированию

### 1. Убедитесь, что сервисы запущены

**Backend:**
```bash
cd backend
python -m venv venv
source venv/bin/activate  # или venv\Scripts\activate на Windows
pip install -r requirements.txt
uvicorn app.main:app --reload --port 8000
```

**Frontend:**
```bash
cd frontend
npm install
npm run dev
```

### 2. Создайте тестового пользователя (если нужно)

```bash
cd backend
python create_test_user.py
```

Или зарегистрируйтесь через UI на `/register`

---

## Сценарий тестирования: Тестовое дело "Контракт на поставку"

### Шаг 1: Создание тестового дела

1. **Войдите в систему** (`/login`)
2. **Перейдите на страницу списка дел** (`/cases`)
3. **Создайте новое дело:**
   - Нажмите кнопку загрузки документов
   - Заполните информацию о деле:
     - **Название:** "Тестовое дело: Контракт на поставку оборудования"
     - **Описание:** "Анализ контракта на поставку IT-оборудования между ООО 'Поставщик' и ООО 'Заказчик'"
     - **Тип дела:** "contracts"

### Шаг 2: Подготовка тестовых документов

Создайте следующие тестовые документы (можно использовать простые текстовые файлы или PDF):

#### Документ 1: `contract_main.txt`
```
КОНТРАКТ НА ПОСТАВКУ ОБОРУДОВАНИЯ

Дата: 15 января 2024 года

СТОРОНЫ:
- Поставщик: ООО "ТехноПоставка", ИНН 1234567890
- Заказчик: ООО "БизнесРешения", ИНН 0987654321

ПРЕДМЕТ КОНТРАКТА:
Поставщик обязуется поставить, а Заказчик принять и оплатить следующее оборудование:
- Серверы: 5 единиц, стоимость 500 000 рублей
- Сетевое оборудование: 10 единиц, стоимость 200 000 рублей
- Общая стоимость: 700 000 рублей

СРОКИ ПОСТАВКИ:
Поставка должна быть осуществлена в течение 30 календарных дней с момента подписания контракта.

УСЛОВИЯ ОПЛАТЫ:
- Предоплата: 50% (350 000 рублей) в течение 5 дней после подписания
- Окончательный расчет: 50% (350 000 рублей) в течение 10 дней после приемки товара

ОТВЕТСТВЕННОСТЬ:
В случае нарушения сроков поставки Поставщик уплачивает пени в размере 0,5% от стоимости непоставленного товара за каждый день просрочки.

ГАРАНТИЙНЫЙ СРОК:
Гарантийный срок на поставляемое оборудование составляет 12 месяцев с момента передачи товара.

ПОДПИСИ:
Поставщик: _________________  Заказчик: _________________
```

#### Документ 2: `addendum_payment.txt`
```
ДОПОЛНИТЕЛЬНОЕ СОГЛАШЕНИЕ №1
к Контракту на поставку оборудования от 15.01.2024

Дата: 20 января 2024 года

СТОРОНЫ:
- Поставщик: ООО "ТехноПоставка"
- Заказчик: ООО "БизнесРешения"

ИЗМЕНЕНИЯ:
1. Срок предоплаты увеличен до 10 дней (вместо 5 дней)
2. Срок окончательного расчета увеличен до 15 дней (вместо 10 дней)
3. Добавлен пункт о возможности отсрочки платежа на 30 дней при предоставлении банковской гарантии

ПОДПИСИ:
Поставщик: _________________  Заказчик: _________________
```

#### Документ 3: `letter_counterparty.txt`
```
ПИСЬМО ОТ ЗАКАЗЧИКА

Дата: 25 января 2024 года
От: ООО "БизнесРешения"
К: ООО "ТехноПоставка"

Уважаемые коллеги!

Настоящим письмом уведомляем вас о следующем:
1. Мы готовы произвести предоплату в размере 50% в течение 3 дней (вместо 10 дней, указанных в дополнительном соглашении)
2. Просим подтвердить возможность поставки оборудования в течение 20 дней (вместо 30 дней по основному контракту)
3. Требуем предоставить сертификаты соответствия на все поставляемое оборудование

С уважением,
Директор ООО "БизнесРешения"
Иванов И.И.
```

### Шаг 3: Загрузка документов

1. **Загрузите все три документа:**
   - Выберите файлы: `contract_main.txt`, `addendum_payment.txt`, `letter_counterparty.txt`
   - Нажмите "Загрузить"
   - Дождитесь завершения обработки (статус должен измениться на "completed")

### Шаг 4: Тестирование функционала

#### 4.1. Обзор дела (`/cases/{caseId}/workspace`)

**Проверьте:**
- ✅ Отображается название дела
- ✅ Показывается количество загруженных документов (3)
- ✅ Вкладка "Обзор" показывает статистику
- ✅ Вкладка "Риски" отображает выявленные риски
- ✅ Вкладка "Противоречия" показывает найденные противоречия
- ✅ Вкладка "Временная линия" показывает события

**Ожидаемые результаты:**
- **Риски:**
  - Разные сроки оплаты в основном контракте и доп. соглашении
  - Разные сроки поставки в контракте и письме
- **Противоречия:**
  - Срок предоплаты: 5 дней (контракт) vs 10 дней (доп. соглашение) vs 3 дня (письмо)
  - Срок поставки: 30 дней (контракт) vs 20 дней (письмо)

#### 4.2. Чат с AI (`/cases/{caseId}/chat`)

**Задайте следующие вопросы:**

1. **"Какая общая стоимость контракта?"**
   - Ожидаемый ответ: 700 000 рублей
   - Проверьте наличие ссылок на источники

2. **"Какие сроки оплаты указаны в документах?"**
   - Ожидаемый ответ: упоминание разных сроков из разных документов
   - Должны быть указаны источники

3. **"Есть ли противоречия в сроках поставки?"**
   - Ожидаемый ответ: да, есть противоречия между контрактом (30 дней) и письмом (20 дней)
   - Должны быть указаны конкретные документы

4. **"Кто является поставщиком и заказчиком?"**
   - Ожидаемый ответ: ООО "ТехноПоставка" (поставщик), ООО "БизнесРешения" (заказчик)

5. **"Какие условия гарантии указаны в контракте?"**
   - Ожидаемый ответ: 12 месяцев с момента передачи товара

**Проверьте:**
- ✅ Ответы точные и релевантные
- ✅ Указаны источники (документы и страницы)
- ✅ История чата сохраняется
- ✅ Можно задавать уточняющие вопросы

#### 4.3. Документы (`/cases/{caseId}/documents`)

**Проверьте:**
- ✅ Все 3 документа отображаются в списке
- ✅ Можно открыть и просмотреть каждый документ
- ✅ Отображается информация о документе (название, дата загрузки)

#### 4.4. Экспорт и отчеты

**Проверьте:**
- ✅ Можно экспортировать анализ
- ✅ Генерируются отчеты с выявленными рисками и противоречиями

---

## Дополнительные тестовые сценарии

### Сценарий 2: Большой объем документов

1. Загрузите 10-15 документов разного типа
2. Проверьте производительность обработки
3. Проверьте, что все документы корректно проиндексированы

### Сценарий 3: Разные форматы файлов

1. Загрузите документы разных форматов:
   - PDF
   - DOCX
   - TXT
   - XLSX (если поддерживается)
2. Проверьте, что все форматы обрабатываются корректно

### Сценарий 4: Сложные вопросы

1. Задайте сложные вопросы, требующие анализа нескольких документов:
   - "Сравните условия оплаты во всех документах"
   - "Какие изменения были внесены в доп. соглашении?"
   - "Есть ли риски для заказчика в этом контракте?"

---

## Чек-лист тестирования

### Функциональность
- [ ] Регистрация и авторизация работают
- [ ] Создание нового дела работает
- [ ] Загрузка документов работает
- [ ] Обработка документов завершается успешно
- [ ] Чат с AI отвечает на вопросы
- [ ] Ответы содержат ссылки на источники
- [ ] История чата сохраняется
- [ ] Обзор дела показывает корректную информацию
- [ ] Риски выявляются корректно
- [ ] Противоречия находятся корректно
- [ ] Временная линия отображается
- [ ] Документы можно просматривать
- [ ] Экспорт работает

### Производительность
- [ ] Загрузка документов не занимает слишком много времени
- [ ] Ответы AI приходят в разумные сроки (< 30 секунд)
- [ ] Интерфейс не тормозит при большом количестве документов

### UI/UX
- [ ] Интерфейс интуитивно понятен
- [ ] Нет ошибок в консоли браузера
- [ ] Все страницы загружаются корректно
- [ ] Адаптивность на разных размерах экрана

---

## Известные проблемы и ограничения

Если вы обнаружите проблемы, зафиксируйте их здесь:

1. **Проблема:** [описание]
   - **Шаги воспроизведения:** [как воспроизвести]
   - **Ожидаемое поведение:** [что должно быть]
   - **Фактическое поведение:** [что происходит]

---

## Контакты для обратной связи

Если у вас возникли вопросы или проблемы при тестировании, свяжитесь с командой разработки.

